<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>משחק הזוגיות שלנו — SPICY MODE 🔥</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg1: #0d0d0f; /* שחור עמוק */
            --bg2: #1a0b0e; /* בורדו כהה */
            --card: #121216ee;
            --text: #e9e9e9;
            --accent: #ff2740; /* אדום פלפל */
            --accent-2: #ff5b7a; /* ורוד פלמינגו */
            --ok: #22c55e;
            --warn: #f59e0b;
            --err: #ef4444;
        }

        * {
            box-sizing: border-box
        }

        html, body {
            height: 100%
        }

        body {
            margin: 0;
            font-family: 'Heebo',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
            color: var(--text);
            background: radial-gradient(1200px 700px at 70% -10%, rgba(255,39,64,.18), transparent 60%), radial-gradient(1000px 600px at 10% 110%, rgba(255,91,122,.12), transparent 60%), linear-gradient(160deg,var(--bg1),var(--bg2));
            background-attachment: fixed;
            display: grid;
            place-items: center;
            overflow-x: hidden
        }

        .smoke {
            position: fixed;
            inset: 0;
            pointer-events: none;
            background: radial-gradient(600px 250px at 80% 0%, rgba(255,39,64,.07), transparent), radial-gradient(700px 400px at 20% 100%, rgba(255,91,122,.06), transparent);
            mix-blend-mode: screen;
            z-index: 0
        }

        .hearts {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 0;
            overflow: hidden
        }

        .heart {
            position: absolute;
            font-size: clamp(14px,2.2vw,28px);
            opacity: .2;
            animation: floatUp linear var(--t) infinite;
            filter: drop-shadow(0 6px 10px rgba(255,39,64,.25))
        }

        @keyframes floatUp {
            from {
                transform: translateY(100vh) translateX(var(--x))
            }

            to {
                transform: translateY(-20vh) translateX(calc(var(--x)*1.2));
                opacity: .06
            }
        }

        .app {
            width: min(940px,96vw);
            z-index: 1
        }

        .card {
            background: var(--card);
            backdrop-filter: blur(8px);
            border-radius: 22px;
            box-shadow: 0 20px 60px rgba(0,0,0,.5);
            padding: clamp(18px,2.4vw,28px);
            border: 1px solid rgba(255,255,255,.04)
        }

        header {
            display: flex;
            align-items: center;
            gap: 14px;
            justify-content: space-between;
            margin-bottom: 8px
        }

        .title {
            display: flex;
            align-items: center;
            gap: 12px
        }

        .logo {
            width: 46px;
            height: 46px;
            display: grid;
            place-items: center;
            border-radius: 14px;
            background: linear-gradient(135deg,var(--accent),var(--accent-2));
            color: #fff;
            font-weight: 800
        }

        h1 {
            margin: 0;
            font-size: clamp(20px,3.4vw,34px)
        }

        .controls {
            display: flex;
            align-items: center;
            gap: 10px
        }

        .btn {
            border: 0;
            outline: none;
            border-radius: 14px;
            padding: 12px 16px;
            font-weight: 700;
            cursor: pointer;
            transition: .2s transform, .2s box-shadow, .2s opacity
        }

            .btn:active {
                transform: translateY(1px)
            }

        .btn-primary {
            background: linear-gradient(135deg,var(--accent),var(--accent-2));
            color: #fff;
            box-shadow: 0 8px 22px rgba(255,39,64,.35)
        }

        .btn-ghost {
            background: #1a1a1e;
            color: var(--text);
            box-shadow: 0 2px 10px rgba(0,0,0,.35);
            border: 1px solid rgba(255,255,255,.06)
        }

        .mode {
            display: flex;
            gap: 10px;
            flex-wrap: wrap
        }

            .mode .btn {
                min-width: 180px
            }

        .section {
            margin-top: 16px
        }

        .muted {
            color: #bdbdbd;
            font-size: 14px
        }

        .progress {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 6px 0 16px
        }

        .bar {
            flex: 1;
            height: 10px;
            background: #222229;
            border-radius: 999px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,.06)
        }

            .bar > span {
                display: block;
                height: 100%;
                width: 0;
                background: linear-gradient(135deg,var(--accent),var(--accent-2));
                transition: width .3s ease
            }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            border-radius: 999px;
            font-size: 13px;
            background: #19191d;
            border: 1px solid rgba(255,255,255,.08)
        }

        .q-card {
            display: grid;
            gap: 16px
        }

        .q-title {
            font-size: clamp(18px,2.5vw,26px);
            font-weight: 800
        }

        .answers {
            display: grid;
            gap: 10px
        }

        .answer {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 14px;
            background: #141418;
            border: 1px solid #2a2a32;
            border-radius: 14px;
            cursor: pointer;
            transition: .18s transform, .18s box-shadow, .18s background
        }

            .answer:hover {
                transform: translateY(-1px);
                box-shadow: 0 8px 20px rgba(0,0,0,.45)
            }

            .answer.correct {
                outline: 2px solid var(--ok);
                background: #0e1a12
            }

            .answer.wrong {
                outline: 2px solid var(--err);
                background: #1a0e11
            }

        .footer {
            display: flex;
            gap: 8px;
            justify-content: space-between;
            align-items: center
        }

        .hidden {
            display: none !important
        }

        .modal {
            position: fixed;
            inset: 0;
            display: none;
            place-items: center;
            background: rgba(0,0,0,.45);
            z-index: 20
        }

            .modal .box {
                background: #16161a;
                width: min(560px,92vw);
                padding: 22px;
                border-radius: 18px;
                border: 1px solid rgba(255,255,255,.08);
                box-shadow: 0 18px 60px rgba(0,0,0,.6)
            }

        .end {
            text-align: center;
            display: grid;
            gap: 14px
        }

        .score {
            font-size: clamp(28px,4vw,46px);
            font-weight: 800
        }

        .share {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap
        }

        .confetti-canvas {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 10
        }

        .player {
            display: flex;
            align-items: center;
            gap: 10px
        }

            .player .btn {
                padding: 10px 12px
            }

            .player .muted {
                font-size: 12px
            }
    </style>
</head>
<body>
    <div class="smoke" aria-hidden="true"></div>
    <div class="hearts" aria-hidden="true" id="hearts"></div>
    <canvas class="confetti-canvas" id="confetti"></canvas>

    <div class="app">
        <div class="card">
            <header>
                <div class="title">
                    <div class="logo">🔥</div>
                    <h1>משחק הזוגיות שלנו — Spicy Only</h1>
                </div>
                <div class="controls">
                    <div class="player">
                        <button class="btn btn-ghost" id="musicToggle" title="נגן/השתק">🎵 נגן</button>
                        <span class="muted" id="musicState">מושתק</span>
                    </div>
                </div>
            </header>

            <!-- מסך פתיחה + בחירת מוד -->
            <section class="section" id="start">
                <p class="muted" style="margin-top:0">הערב הולך להיות חם. עונים נכון – צוברים 💗. טועים – מקבלים "חובה" רנדומלית מהמאגרים שלנו 😉</p>
                <div class="mode" style="margin-bottom:10px">
                    <button class="btn btn-ghost" id="modeSoft">עדין ורומנטי</button>
                    <button class="btn btn-ghost" id="modeFun">מצחיק ומתוק</button>
                    <button class="btn btn-primary" id="modeSpicy">SPICY — מתחילים</button>
                </div>
            </section>

            <!-- פס התקדמות -->
            <div class="progress hidden" id="progressWrap">
                <span class="pill">שאלה <span id="qIndex">1</span>/<span id="qTotal">10</span></span>
                <div class="bar"><span id="bar"></span></div>
                <span class="pill" id="scorePill">💗 0</span>
            </div>

            <!-- קלף שאלה -->
            <section class="q-card section hidden" id="qCard">
                <div class="q-title" id="qTitle">כאן תופיע השאלה</div>
                <div class="answers" id="answers"></div>
                <div class="footer">
                    <span class="muted" id="feedback"></span>
                    <div style="display:flex; gap:8px">
                        <button class="btn btn-ghost" id="skipBtn" title="דלג (לא נספר בציון)">דלג</button>
                        <button class="btn btn-primary" id="nextBtn" disabled>הבא ▶</button>
                    </div>
                </div>
            </section>

            <!-- מסך סיום -->
            <section class="end section hidden" id="end">
                <div class="score" id="finalScore">ציון: 0</div>
                <div id="endMsg">סיימתם כמו אלופים 💖</div>
                <div class="share">
                    <button class="btn btn-primary" id="againBtn">שחקו שוב</button>
                    <a class="btn btn-ghost" id="whBtn" target="_blank" rel="noopener">לשתף בווצאפ</a>
                </div>
                <p class="muted">רוצה לערוך שאלות? ערוך את המערך <strong>QUESTIONS</strong> בקוד למטה.</p>
            </section>
        </div>
    </div>

    <!-- מוזיקת רקע (אותה רצועה כמו מקודם) -->
    <audio id="bgm" preload="auto" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_2f3d5c8cd6.mp3?filename=romantic-110997.mp3" type="audio/mpeg">
    </audio>

    <!-- מודל חובות -->
    <div class="modal" id="punishModal" role="dialog" aria-modal="true">
        <div class="box">
            <h3 style="margin-top:0">חובה רנדומלית 🔥</h3>
            <p id="punishText">…</p>
            <div style="display:flex; gap:8px; justify-content:flex-end">
                <button class="btn btn-ghost" id="skipPunish">נדלג</button>
                <button class="btn btn-primary" id="okPunish">בוצע ✔️</button>
            </div>
        </div>
    </div>

    <canvas class="confetti-canvas" id="confettiTop"></canvas>

    <script>
        // ===== HEARTS BG =====
        (function makeHearts() {
            const wrap = document.getElementById('hearts');
            const N = 26; const emojis = ['❤', '💗', '💖', '💞', '💘'];
            for (let i = 0; i < N; i++) {
                const s = document.createElement('div'); s.className = 'heart'; s.textContent = emojis[i % emojis.length];
                const left = Math.random() * 100, dur = 18 + Math.random() * 18, x = (Math.random() - .5) * 80;
                s.style.left = left + '%'; s.style.setProperty('--t', dur + 's'); s.style.setProperty('--x', x + 'px'); s.style.animationDelay = (-Math.random() * dur) + 's';
                wrap.appendChild(s);
            }
        })();

        // ===== CONFETTI =====
        const confetti = (() => {
            const canvas = document.getElementById('confetti');
            const ctx = canvas.getContext('2d'); let W, H, raf, pieces = [];
            function resize() { W = canvas.width = innerWidth; H = canvas.height = innerHeight }
            addEventListener('resize', resize); resize();
            function burst(x = W / 2, y = H / 2, n = 90) { for (let i = 0; i < n; i++) { pieces.push({ x, y, vx: (Math.random() * 6 - 3), vy: (Math.random() * -6 - 2), g: .15 + Math.random() * .08, s: 3 + Math.random() * 3, a: 1 }); } if (!raf) loop(); }
            function loop() { raf = requestAnimationFrame(loop); ctx.clearRect(0, 0, W, H); pieces = pieces.filter(p => p.a > 0 && p.y < H + 20); for (const p of pieces) { p.vy += p.g; p.x += p.vx; p.y += p.vy; p.a -= .007; ctx.globalAlpha = p.a; ctx.fillStyle = ['#ff2740', '#ff5b7a', '#ffd1dc', '#ffb3c6'][Math.floor(Math.random() * 4)]; ctx.fillRect(p.x, p.y, p.s, p.s); } if (!pieces.length) { cancelAnimationFrame(raf); raf = null } }
            return { burst };
        })();

        const QUESTIONS = [
            { type: 'mc', q: 'באיזה עיר היה הדייט הראשון שלנו?', options: ['תל אביב', 'נתניה', 'קיסריה', 'חיפה'], a: 2 },
            { type: 'mc', q: 'מה המאכל שאת הכי אוהבת?', options: ['פיצה', 'סושי', 'בננה בפיתה', 'פסטה'], a: 1 },
            { type: 'mc', q: 'מה המאכל שאני הכי אוהב?', options: ['פסטה', 'שניצל', 'פלאפל', 'חביתה'], a: 1 },
            { type: 'text', q: 'איך נועם קורא לחבר שלו?', answer: ['גנץ'] },
            { type: 'mc', q: 'מה הכינוי שאני קורא לך?', options: ['בובו', 'נוניצקה', 'נסיכה', 'דובי'], a: 1 },
            { type: 'mc', q: 'מי נרדם קודם?', options: ['נועם הגדול', 'נועם הגדולה', 'שנינו ביחד', 'תלוי בסרט'], a: 1 },
            { type: 'mc', q: 'אם היינו עכשיו בחופשה, לאן היינו טסים?', options: ['יוון', 'צרפת', 'יפן', 'איטליה'], a: 2 },
            { type: 'text', q: 'כששיחקנו GeoGuessr, איזה יעד יצא הכי הרבה פעמים?', answer: ['חיפה'] },
            { type: 'mc', q: 'מה צבע העיניים של נועם?', options: ['חום', 'כחול', 'ירוק', 'אפור'], a: 1 },
            { type: 'mc', q: 'מה נועם הכי אוהב להריח בנועם הגדולה?', options: ['הבושם שלה', 'את השיער שלה', 'הסדין שלה', 'את האוכל שלה'], a: 1 },


            // שאלות ידע כללי בינוניות
            { type: 'mc', q: 'כמה יבשות יש בעולם?', options: ['5', '6', '7', '8'], a: 2 },
            { type: 'mc', q: 'מהו הכוכב הקרוב ביותר לשמש?', options: ['נוגה', 'כדור הארץ', 'מרקורי', 'מאדים'], a: 2 },
            { type: 'mc', q: 'מי כתב את המחזה רומיאו ויוליה?', options: ['צ׳ארלס דיקנס', 'ויליאם שייקספיר', 'ג׳ורג׳ אורוול', 'לאונרדו דה וינצ׳י'], a: 1 },
            { type: 'mc', q: 'איזו מדינה נחשבת לגדולה ביותר בעולם בשטחה?', options: ['קנדה', 'סין', 'רוסיה', 'ארה״ב'], a: 2 },
            { type: 'mc', q: 'מהו המטבע הרשמי של יפן?', options: ['ין', 'וואן', 'דולר', 'פזו'], a: 0 },
            { type: 'mc', q: 'באיזו שנה נחת האדם הראשון על הירח?', options: ['1965', '1969', '1971', '1975'], a: 1 },
            { type: 'mc', q: 'כמה דקות יש בשעה ורבע?', options: ['60', '75', '90', '120'], a: 2 },
            { type: 'mc', q: 'מהי העיר הבירה של קנדה?', options: ['טורונטו', 'מונטריאול', 'אוטווה', 'ונקובר'], a: 2 },
            { type: 'mc', q: 'איזה יסוד כימי מסומן באות H?', options: ['חמצן', 'מימן', 'הליום', 'פחמן'], a: 1 },
            { type: 'mc', q: 'באיזו יבשת נמצאת מדינת מצרים?', options: ['אסיה', 'אפריקה', 'אירופה', 'דרום אמריקה'], a: 1 },


            // שאלות קשות
            { type: 'mc', q: 'מהו שמו של החור השחור שבמרכז גלקסיית שביל החלב?', options: ['סגיטריוס A*', 'אוריון B', 'קוואזר X1', 'אנדרומדה C'], a: 0 },
            { type: 'mc', q: 'באיזו שנה התרחשה המהפכה הצרפתית?', options: ['1776', '1789', '1804', '1812'], a: 1 },


            // שאלות קלות במיוחד
            { type: 'mc', q: 'כמה רגליים יש לעכביש?', options: ['6', '8', '10', '12'], a: 1 },
            { type: 'mc', q: 'מה צבע הדם של בני האדם?', options: ['כחול', 'אדום', 'סגול', 'שחור'], a: 1 },
            { type: 'mc', q: 'כמה שניות יש בדקה?', options: ['30', '45', '60', '90'], a: 2 },
            { type: 'mc', q: 'איזה חיה נובחת?', options: ['חתול', 'כלב', 'דג', 'פרה'], a: 1 },
            { type: 'mc', q: 'מהי בירת ישראל?', options: ['תל אביב', 'ירושלים', 'חיפה', 'באר שבע'], a: 1 }
        ];

        const PUNISH = [
            'תבחרי מקום מעניין שאני אגע בו 10 שניות רצוף את בוחרת מקום 😉',
            'תביאי לי נשיקה איפה שבאלך)',
            'אני בוחר מקום לגעת בו ל5 שניות אבל',
            'אני בוחר מקום שאת נוגעת בו ל10 שניות',
            'את בוחרת מקום שאת נוגעת בו אבל 5 שניות',
            'אני מתחת לבגד',
            'את מתחת לבגד',
            'נשיקה איפה שבאלך',
            'נשיקה איפה שאני בוחר',
            'נשיקה עם לשון והרבה זמן',
            'נשיקה תוך כדי שאני מרים אותך',
            'חיבוק עם נגיעות ונשיקה',
            'כל אחד אומר 3 דברים שמושכים אותו בשני',
            'אני יושב עליך ל10 שניות',
            'את יושבת עלי ל10 שניות',
        ];

        // ===== STATE & DOM =====
        const state = { idx: 0, score: 0, order: [...Array(QUESTIONS.length).keys()], answered: false };
        const el = id => document.getElementById(id);
        const qCard = el('qCard'), qTitle = el('qTitle'), answers = el('answers'), qIndex = el('qIndex'), qTotal = el('qTotal'), bar = el('bar'), progressWrap = el('progressWrap'), feedback = el('feedback'), scorePill = el('scorePill'), end = el('end'), finalScore = el('finalScore'), endMsg = el('endMsg'), whBtn = el('whBtn');
        const nextBtn = el('nextBtn'), skipBtn = el('skipBtn');
        const start = el('start');

        // Music
        const bgm = el('bgm'); const musicToggle = el('musicToggle'); const musicState = el('musicState'); let musicOn = false;
        musicToggle.addEventListener('click', async () => { try { if (!musicOn) { await bgm.play(); musicOn = true; musicState.textContent = 'מנגן'; musicToggle.innerHTML = '⏸️ השתק'; } else { bgm.pause(); musicOn = false; musicState.textContent = 'מושתק'; musicToggle.innerHTML = '🎵 נגן'; } } catch (e) { alert('ייתכן שהדפדפן חסם ניגון אוטומטי. נסו ללחוץ שוב.'); } });
        document.addEventListener('click', async function once() { document.removeEventListener('click', once); try { await bgm.play(); musicOn = true; musicState.textContent = 'מנגן'; musicToggle.innerHTML = '⏸️ השתק'; } catch (e) { } }, { once: true, capture: true });

        // Modes
        el('modeSoft').addEventListener('click', () => { alert(" נראלך?! היום מתפרעים!"); });
        el('modeFun').addEventListener('click', () => { alert('מצחיק ומתוק זה לא היום.. אולי רק מתוק'); });
        el('modeSpicy').addEventListener('click', () => { start.classList.add('hidden'); qCard.classList.remove('hidden'); progressWrap.classList.remove('hidden'); initGame(); });

        function initGame() { state.idx = 0; state.score = 0; state.answered = false; scorePill.textContent = '💗 0'; qTotal.textContent = state.order.length; showQuestion(); }

        nextBtn.addEventListener('click', () => { state.idx++; if (state.idx >= state.order.length) return finish(); showQuestion(); });
        skipBtn.addEventListener('click', () => { feedback.textContent = 'דילוג אלגנטי. ממשיכים ❤️'; nextBtn.disabled = false; });

        function pct() { return Math.round(100 * state.idx / state.order.length) }
        function normalize(t) { return (t || '').toString().trim().toLowerCase().replace(/["'״׳\-]/g, '').replace(/\s+/g, ' ') }

        function showQuestion() {
            state.answered = false; feedback.textContent = ''; nextBtn.disabled = true;
            const qi = state.order[state.idx]; const q = QUESTIONS[qi];
            qIndex.textContent = state.idx + 1; bar.style.width = pct() + '%'; qTitle.textContent = q.q; answers.innerHTML = '';
            if (q.type === 'mc') {
                q.options.forEach((opt, i) => {
                    const btn = document.createElement('button'); btn.className = 'answer'; btn.type = 'button'; btn.textContent = opt;
                    btn.addEventListener('click', () => selectAnswer(btn, i === q.a)); answers.appendChild(btn);
                });
            } else { // text
                const wrap = document.createElement('div'); wrap.style.display = 'grid'; wrap.style.gap = '10px';
                const input = document.createElement('input'); input.type = 'text'; input.placeholder = 'כתבו כאן תשובה'; input.style.padding = '12px 14px'; input.style.border = '1px solid #2a2a32'; input.style.borderRadius = '12px'; input.style.background = '#0f0f13'; input.style.color = 'var(--text)';
                const btn = document.createElement('button'); btn.className = 'btn btn-primary'; btn.textContent = 'בדיקה';
                btn.addEventListener('click', () => {
                    const val = normalize(input.value);
                    let ok = false;
                    if (Array.isArray(q.answer)) ok = q.answer.some(a => val.includes(normalize(a)) || normalize(a).includes(val));
                    else ok = val === normalize(q.answer);
                    selectAnswer(btn, ok, true);
                });
                wrap.appendChild(input); wrap.appendChild(btn); answers.appendChild(wrap);
            }
        }

        function selectAnswer(node, correct, isText = false) {
            if (state.answered) return; state.answered = true;
            if (!isText) { [...answers.querySelectorAll('.answer')].forEach(b => b.disabled = true); node.classList.add(correct ? 'correct' : 'wrong'); }
            if (correct) { state.score++; scorePill.textContent = '💗 ' + state.score; feedback.textContent = 'בול! 🌟'; confetti.burst(); }
            else { feedback.textContent = 'פספסת… חובה רנדומלית בדרך!'; showPunish(); }
            nextBtn.disabled = false;
        }

        // Punish modal
        const punishModal = document.getElementById('punishModal');
        const punishText = document.getElementById('punishText');
        document.getElementById('okPunish').addEventListener('click', () => { punishModal.style.display = 'none' });
        document.getElementById('skipPunish').addEventListener('click', () => { punishModal.style.display = 'none' });
        function showPunish() {
            punishText.textContent = PUNISH[Math.floor(Math.random() * PUNISH.length)];
            punishModal.style.display = 'grid';
        }

        function finish() {
            qCard.classList.add('hidden'); progressWrap.classList.add('hidden'); end.classList.remove('hidden');
            finalScore.textContent = 'ציון: ' + state.score + '/' + state.order.length;
            const rate = state.score / state.order.length;
            endMsg.textContent = rate >= .8 ? 'חם פה… המשכיות מתבקשת 😉' : (rate >= .6 ? 'יש מתח באוויר – סיבוב נוסף?' : 'הציון לא קובע, הקרבה כן. ממשיכים?');
            confetti.burst(innerWidth / 2, innerHeight / 3, 140);
            const shareTxt = encodeURIComponent(`סיימנו את "Spicy Mode" עם ציון ${state.score}/${state.order.length} 🔥`);
            whBtn.href = `https://wa.me/?text=${shareTxt}`;
        }
    </script>
</body>
</html>
