<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>××©×—×§ ×”×–×•×’×™×•×ª ×©×œ× ×• â€” SPICY MODE ğŸ”¥</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg1: #0d0d0f; /* ×©×—×•×¨ ×¢××•×§ */
            --bg2: #1a0b0e; /* ×‘×•×¨×“×• ×›×”×” */
            --card: #121216ee;
            --text: #e9e9e9;
            --accent: #ff2740; /* ××“×•× ×¤×œ×¤×œ */
            --accent-2: #ff5b7a; /* ×•×¨×•×“ ×¤×œ××™× ×’×• */
            --ok: #22c55e;
            --warn: #f59e0b;
            --err: #ef4444;
        }

        * {
            box-sizing: border-box
        }

        html, body {
            height: 100%
        }

        body {
            margin: 0;
            font-family: 'Heebo',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
            color: var(--text);
            background: radial-gradient(1200px 700px at 70% -10%, rgba(255,39,64,.18), transparent 60%), radial-gradient(1000px 600px at 10% 110%, rgba(255,91,122,.12), transparent 60%), linear-gradient(160deg,var(--bg1),var(--bg2));
            background-attachment: fixed;
            display: grid;
            place-items: center;
            overflow-x: hidden
        }

        .smoke {
            position: fixed;
            inset: 0;
            pointer-events: none;
            background: radial-gradient(600px 250px at 80% 0%, rgba(255,39,64,.07), transparent), radial-gradient(700px 400px at 20% 100%, rgba(255,91,122,.06), transparent);
            mix-blend-mode: screen;
            z-index: 0
        }

        .hearts {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 0;
            overflow: hidden
        }

        .heart {
            position: absolute;
            font-size: clamp(14px,2.2vw,28px);
            opacity: .2;
            animation: floatUp linear var(--t) infinite;
            filter: drop-shadow(0 6px 10px rgba(255,39,64,.25))
        }

        @keyframes floatUp {
            from {
                transform: translateY(100vh) translateX(var(--x))
            }

            to {
                transform: translateY(-20vh) translateX(calc(var(--x)*1.2));
                opacity: .06
            }
        }

        .app {
            width: min(940px,96vw);
            z-index: 1
        }

        .card {
            background: var(--card);
            backdrop-filter: blur(8px);
            border-radius: 22px;
            box-shadow: 0 20px 60px rgba(0,0,0,.5);
            padding: clamp(18px,2.4vw,28px);
            border: 1px solid rgba(255,255,255,.04)
        }

        header {
            display: flex;
            align-items: center;
            gap: 14px;
            justify-content: space-between;
            margin-bottom: 8px
        }

        .title {
            display: flex;
            align-items: center;
            gap: 12px
        }

        .logo {
            width: 46px;
            height: 46px;
            display: grid;
            place-items: center;
            border-radius: 14px;
            background: linear-gradient(135deg,var(--accent),var(--accent-2));
            color: #fff;
            font-weight: 800
        }

        h1 {
            margin: 0;
            font-size: clamp(20px,3.4vw,34px)
        }

        .controls {
            display: flex;
            align-items: center;
            gap: 10px
        }

        .btn {
            border: 0;
            outline: none;
            border-radius: 14px;
            padding: 12px 16px;
            font-weight: 700;
            cursor: pointer;
            transition: .2s transform, .2s box-shadow, .2s opacity
        }

            .btn:active {
                transform: translateY(1px)
            }

        .btn-primary {
            background: linear-gradient(135deg,var(--accent),var(--accent-2));
            color: #fff;
            box-shadow: 0 8px 22px rgba(255,39,64,.35)
        }

        .btn-ghost {
            background: #1a1a1e;
            color: var(--text);
            box-shadow: 0 2px 10px rgba(0,0,0,.35);
            border: 1px solid rgba(255,255,255,.06)
        }

        .mode {
            display: flex;
            gap: 10px;
            flex-wrap: wrap
        }

            .mode .btn {
                min-width: 180px
            }

        .section {
            margin-top: 16px
        }

        .muted {
            color: #bdbdbd;
            font-size: 14px
        }

        .progress {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 6px 0 16px
        }

        .bar {
            flex: 1;
            height: 10px;
            background: #222229;
            border-radius: 999px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,.06)
        }

            .bar > span {
                display: block;
                height: 100%;
                width: 0;
                background: linear-gradient(135deg,var(--accent),var(--accent-2));
                transition: width .3s ease
            }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            border-radius: 999px;
            font-size: 13px;
            background: #19191d;
            border: 1px solid rgba(255,255,255,.08)
        }

        .q-card {
            display: grid;
            gap: 16px
        }

        .q-title {
            font-size: clamp(18px,2.5vw,26px);
            font-weight: 800
        }

        .answers {
            display: grid;
            gap: 10px
        }

        .answer {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 14px;
            background: #141418;
            border: 1px solid #2a2a32;
            border-radius: 14px;
            cursor: pointer;
            transition: .18s transform, .18s box-shadow, .18s background
        }

            .answer:hover {
                transform: translateY(-1px);
                box-shadow: 0 8px 20px rgba(0,0,0,.45)
            }

            .answer.correct {
                outline: 2px solid var(--ok);
                background: #0e1a12
            }

            .answer.wrong {
                outline: 2px solid var(--err);
                background: #1a0e11
            }

        .footer {
            display: flex;
            gap: 8px;
            justify-content: space-between;
            align-items: center
        }

        .hidden {
            display: none !important
        }

        .modal {
            position: fixed;
            inset: 0;
            display: none;
            place-items: center;
            background: rgba(0,0,0,.45);
            z-index: 20
        }

            .modal .box {
                background: #16161a;
                width: min(560px,92vw);
                padding: 22px;
                border-radius: 18px;
                border: 1px solid rgba(255,255,255,.08);
                box-shadow: 0 18px 60px rgba(0,0,0,.6)
            }

        .end {
            text-align: center;
            display: grid;
            gap: 14px
        }

        .score {
            font-size: clamp(28px,4vw,46px);
            font-weight: 800
        }

        .share {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap
        }

        .confetti-canvas {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 10
        }

        .player {
            display: flex;
            align-items: center;
            gap: 10px
        }

            .player .btn {
                padding: 10px 12px
            }

            .player .muted {
                font-size: 12px
            }
    </style>
</head>
<body>
    <div class="smoke" aria-hidden="true"></div>
    <div class="hearts" aria-hidden="true" id="hearts"></div>
    <canvas class="confetti-canvas" id="confetti"></canvas>

    <div class="app">
        <div class="card">
            <header>
                <div class="title">
                    <div class="logo">ğŸ”¥</div>
                    <h1>××©×—×§ ×”×–×•×’×™×•×ª ×©×œ× ×• â€” Spicy Only</h1>
                </div>
                <div class="controls">
                    <div class="player">
                        <button class="btn btn-ghost" id="musicToggle" title="× ×’×Ÿ/×”×©×ª×§">ğŸµ × ×’×Ÿ</button>
                        <span class="muted" id="musicState">××•×©×ª×§</span>
                    </div>
                </div>
            </header>

            <!-- ××¡×š ×¤×ª×™×—×” + ×‘×—×™×¨×ª ××•×“ -->
            <section class="section" id="start">
                <p class="muted" style="margin-top:0">×”×¢×¨×‘ ×”×•×œ×š ×œ×”×™×•×ª ×—×. ×¢×•× ×™× × ×›×•×Ÿ â€“ ×¦×•×‘×¨×™× ğŸ’—. ×˜×•×¢×™× â€“ ××§×‘×œ×™× "×—×•×‘×”" ×¨× ×“×•××œ×™×ª ××”×××’×¨×™× ×©×œ× ×• ğŸ˜‰</p>
                <div class="mode" style="margin-bottom:10px">
                    <button class="btn btn-ghost" id="modeSoft">×¢×“×™×Ÿ ×•×¨×•×× ×˜×™</button>
                    <button class="btn btn-ghost" id="modeFun">××¦×—×™×§ ×•××ª×•×§</button>
                    <button class="btn btn-primary" id="modeSpicy">SPICY â€” ××ª×—×™×œ×™×</button>
                </div>
            </section>

            <!-- ×¤×¡ ×”×ª×§×“××•×ª -->
            <div class="progress hidden" id="progressWrap">
                <span class="pill">×©××œ×” <span id="qIndex">1</span>/<span id="qTotal">10</span></span>
                <div class="bar"><span id="bar"></span></div>
                <span class="pill" id="scorePill">ğŸ’— 0</span>
            </div>

            <!-- ×§×œ×£ ×©××œ×” -->
            <section class="q-card section hidden" id="qCard">
                <div class="q-title" id="qTitle">×›××Ÿ ×ª×•×¤×™×¢ ×”×©××œ×”</div>
                <div class="answers" id="answers"></div>
                <div class="footer">
                    <span class="muted" id="feedback"></span>
                    <div style="display:flex; gap:8px">
                        <button class="btn btn-ghost" id="skipBtn" title="×“×œ×’ (×œ× × ×¡×¤×¨ ×‘×¦×™×•×Ÿ)">×“×œ×’</button>
                        <button class="btn btn-primary" id="nextBtn" disabled>×”×‘× â–¶</button>
                    </div>
                </div>
            </section>

            <!-- ××¡×š ×¡×™×•× -->
            <section class="end section hidden" id="end">
                <div class="score" id="finalScore">×¦×™×•×Ÿ: 0</div>
                <div id="endMsg">×¡×™×™××ª× ×›××• ××œ×•×¤×™× ğŸ’–</div>
                <div class="share">
                    <button class="btn btn-primary" id="againBtn">×©×—×§×• ×©×•×‘</button>
                    <a class="btn btn-ghost" id="whBtn" target="_blank" rel="noopener">×œ×©×ª×£ ×‘×•×•×¦××¤</a>
                </div>
                <p class="muted">×¨×•×¦×” ×œ×¢×¨×•×š ×©××œ×•×ª? ×¢×¨×•×š ××ª ×”××¢×¨×š <strong>QUESTIONS</strong> ×‘×§×•×“ ×œ××˜×”.</p>
            </section>
        </div>
    </div>

    <!-- ××•×–×™×§×ª ×¨×§×¢ (××•×ª×” ×¨×¦×•×¢×” ×›××• ××§×•×“×) -->
    <audio id="bgm" preload="auto" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_2f3d5c8cd6.mp3?filename=romantic-110997.mp3" type="audio/mpeg">
    </audio>

    <!-- ××•×“×œ ×—×•×‘×•×ª -->
    <div class="modal" id="punishModal" role="dialog" aria-modal="true">
        <div class="box">
            <h3 style="margin-top:0">×—×•×‘×” ×¨× ×“×•××œ×™×ª ğŸ”¥</h3>
            <p id="punishText">â€¦</p>
            <div style="display:flex; gap:8px; justify-content:flex-end">
                <button class="btn btn-ghost" id="skipPunish">× ×“×œ×’</button>
                <button class="btn btn-primary" id="okPunish">×‘×•×¦×¢ âœ”ï¸</button>
            </div>
        </div>
    </div>

    <canvas class="confetti-canvas" id="confettiTop"></canvas>

    <script>
        // ===== HEARTS BG =====
        (function makeHearts() {
            const wrap = document.getElementById('hearts');
            const N = 26; const emojis = ['â¤', 'ğŸ’—', 'ğŸ’–', 'ğŸ’', 'ğŸ’˜'];
            for (let i = 0; i < N; i++) {
                const s = document.createElement('div'); s.className = 'heart'; s.textContent = emojis[i % emojis.length];
                const left = Math.random() * 100, dur = 18 + Math.random() * 18, x = (Math.random() - .5) * 80;
                s.style.left = left + '%'; s.style.setProperty('--t', dur + 's'); s.style.setProperty('--x', x + 'px'); s.style.animationDelay = (-Math.random() * dur) + 's';
                wrap.appendChild(s);
            }
        })();

        // ===== CONFETTI =====
        const confetti = (() => {
            const canvas = document.getElementById('confetti');
            const ctx = canvas.getContext('2d'); let W, H, raf, pieces = [];
            function resize() { W = canvas.width = innerWidth; H = canvas.height = innerHeight }
            addEventListener('resize', resize); resize();
            function burst(x = W / 2, y = H / 2, n = 90) { for (let i = 0; i < n; i++) { pieces.push({ x, y, vx: (Math.random() * 6 - 3), vy: (Math.random() * -6 - 2), g: .15 + Math.random() * .08, s: 3 + Math.random() * 3, a: 1 }); } if (!raf) loop(); }
            function loop() { raf = requestAnimationFrame(loop); ctx.clearRect(0, 0, W, H); pieces = pieces.filter(p => p.a > 0 && p.y < H + 20); for (const p of pieces) { p.vy += p.g; p.x += p.vx; p.y += p.vy; p.a -= .007; ctx.globalAlpha = p.a; ctx.fillStyle = ['#ff2740', '#ff5b7a', '#ffd1dc', '#ffb3c6'][Math.floor(Math.random() * 4)]; ctx.fillRect(p.x, p.y, p.s, p.s); } if (!pieces.length) { cancelAnimationFrame(raf); raf = null } }
            return { burst };
        })();

        const QUESTIONS = [
            { type: 'mc', q: '×‘××™×–×” ×¢×™×¨ ×”×™×” ×”×“×™×™×˜ ×”×¨××©×•×Ÿ ×©×œ× ×•?', options: ['×ª×œ ××‘×™×‘', '× ×ª× ×™×”', '×§×™×¡×¨×™×”', '×—×™×¤×”'], a: 2 },
            { type: 'mc', q: '××” ×”×××›×œ ×©××ª ×”×›×™ ××•×”×‘×ª?', options: ['×¤×™×¦×”', '×¡×•×©×™', '×‘× × ×” ×‘×¤×™×ª×”', '×¤×¡×˜×”'], a: 1 },
            { type: 'mc', q: '××” ×”×××›×œ ×©×× ×™ ×”×›×™ ××•×”×‘?', options: ['×¤×¡×˜×”', '×©× ×™×¦×œ', '×¤×œ××¤×œ', '×—×‘×™×ª×”'], a: 1 },
            { type: 'text', q: '××™×š × ×•×¢× ×§×•×¨× ×œ×—×‘×¨ ×©×œ×•?', answer: ['×’× ×¥'] },
            { type: 'mc', q: '××” ×”×›×™× ×•×™ ×©×× ×™ ×§×•×¨× ×œ×š?', options: ['×‘×•×‘×•', '× ×•× ×™×¦×§×”', '× ×¡×™×›×”', '×“×•×‘×™'], a: 1 },
            { type: 'mc', q: '××™ × ×¨×“× ×§×•×“×?', options: ['× ×•×¢× ×”×’×“×•×œ', '× ×•×¢× ×”×’×“×•×œ×”', '×©× ×™× ×• ×‘×™×—×“', '×ª×œ×•×™ ×‘×¡×¨×˜'], a: 1 },
            { type: 'mc', q: '×× ×”×™×™× ×• ×¢×›×©×™×• ×‘×—×•×¤×©×”, ×œ××Ÿ ×”×™×™× ×• ×˜×¡×™×?', options: ['×™×•×•×Ÿ', '×¦×¨×¤×ª', '×™×¤×Ÿ', '××™×˜×œ×™×”'], a: 2 },
            { type: 'text', q: '×›×©×©×™×—×§× ×• GeoGuessr, ××™×–×” ×™×¢×“ ×™×¦× ×”×›×™ ×”×¨×‘×” ×¤×¢××™×?', answer: ['×—×™×¤×”'] },
            { type: 'mc', q: '××” ×¦×‘×¢ ×”×¢×™× ×™×™× ×©×œ × ×•×¢×?', options: ['×—×•×', '×›×—×•×œ', '×™×¨×•×§', '××¤×•×¨'], a: 1 },
            { type: 'mc', q: '××” × ×•×¢× ×”×›×™ ××•×”×‘ ×œ×”×¨×™×— ×‘× ×•×¢× ×”×’×“×•×œ×”?', options: ['×”×‘×•×©× ×©×œ×”', '××ª ×”×©×™×¢×¨ ×©×œ×”', '×”×¡×“×™×Ÿ ×©×œ×”', '××ª ×”××•×›×œ ×©×œ×”'], a: 1 },


            // ×©××œ×•×ª ×™×“×¢ ×›×œ×œ×™ ×‘×™× ×•× ×™×•×ª
            { type: 'mc', q: '×›××” ×™×‘×©×•×ª ×™×© ×‘×¢×•×œ×?', options: ['5', '6', '7', '8'], a: 2 },
            { type: 'mc', q: '××”×• ×”×›×•×›×‘ ×”×§×¨×•×‘ ×‘×™×•×ª×¨ ×œ×©××©?', options: ['× ×•×’×”', '×›×“×•×¨ ×”××¨×¥', '××¨×§×•×¨×™', '×××“×™×'], a: 2 },
            { type: 'mc', q: '××™ ×›×ª×‘ ××ª ×”××—×–×” ×¨×•××™××• ×•×™×•×œ×™×”?', options: ['×¦×³××¨×œ×¡ ×“×™×§× ×¡', '×•×™×œ×™×× ×©×™×™×§×¡×¤×™×¨', '×’×³×•×¨×’×³ ××•×¨×•×•×œ', '×œ××•× ×¨×“×• ×“×” ×•×™× ×¦×³×™'], a: 1 },
            { type: 'mc', q: '××™×–×• ××“×™× ×” × ×—×©×‘×ª ×œ×’×“×•×œ×” ×‘×™×•×ª×¨ ×‘×¢×•×œ× ×‘×©×˜×—×”?', options: ['×§× ×“×”', '×¡×™×Ÿ', '×¨×•×¡×™×”', '××¨×”×´×‘'], a: 2 },
            { type: 'mc', q: '××”×• ×”××˜×‘×¢ ×”×¨×©××™ ×©×œ ×™×¤×Ÿ?', options: ['×™×Ÿ', '×•×•××Ÿ', '×“×•×œ×¨', '×¤×–×•'], a: 0 },
            { type: 'mc', q: '×‘××™×–×• ×©× ×” × ×—×ª ×”××“× ×”×¨××©×•×Ÿ ×¢×œ ×”×™×¨×—?', options: ['1965', '1969', '1971', '1975'], a: 1 },
            { type: 'mc', q: '×›××” ×“×§×•×ª ×™×© ×‘×©×¢×” ×•×¨×‘×¢?', options: ['60', '75', '90', '120'], a: 2 },
            { type: 'mc', q: '××”×™ ×”×¢×™×¨ ×”×‘×™×¨×” ×©×œ ×§× ×“×”?', options: ['×˜×•×¨×•× ×˜×•', '××•× ×˜×¨×™××•×œ', '××•×˜×•×•×”', '×•× ×§×•×‘×¨'], a: 2 },
            { type: 'mc', q: '××™×–×” ×™×¡×•×“ ×›×™××™ ××¡×•××Ÿ ×‘××•×ª H?', options: ['×—××¦×Ÿ', '××™××Ÿ', '×”×œ×™×•×', '×¤×—××Ÿ'], a: 1 },
            { type: 'mc', q: '×‘××™×–×• ×™×‘×©×ª × ××¦××ª ××“×™× ×ª ××¦×¨×™×?', options: ['××¡×™×”', '××¤×¨×™×§×”', '××™×¨×•×¤×”', '×“×¨×•× ×××¨×™×§×”'], a: 1 },


            // ×©××œ×•×ª ×§×©×•×ª
            { type: 'mc', q: '××”×• ×©××• ×©×œ ×”×—×•×¨ ×”×©×—×•×¨ ×©×‘××¨×›×– ×’×œ×§×¡×™×™×ª ×©×‘×™×œ ×”×—×œ×‘?', options: ['×¡×’×™×˜×¨×™×•×¡ A*', '××•×¨×™×•×Ÿ B', '×§×•×•××–×¨ X1', '×× ×“×¨×•××“×” C'], a: 0 },
            { type: 'mc', q: '×‘××™×–×• ×©× ×” ×”×ª×¨×—×©×” ×”××”×¤×›×” ×”×¦×¨×¤×ª×™×ª?', options: ['1776', '1789', '1804', '1812'], a: 1 },


            // ×©××œ×•×ª ×§×œ×•×ª ×‘××™×•×—×“
            { type: 'mc', q: '×›××” ×¨×’×œ×™×™× ×™×© ×œ×¢×›×‘×™×©?', options: ['6', '8', '10', '12'], a: 1 },
            { type: 'mc', q: '××” ×¦×‘×¢ ×”×“× ×©×œ ×‘× ×™ ×”××“×?', options: ['×›×—×•×œ', '××“×•×', '×¡×’×•×œ', '×©×—×•×¨'], a: 1 },
            { type: 'mc', q: '×›××” ×©× ×™×•×ª ×™×© ×‘×“×§×”?', options: ['30', '45', '60', '90'], a: 2 },
            { type: 'mc', q: '××™×–×” ×—×™×” × ×•×‘×—×ª?', options: ['×—×ª×•×œ', '×›×œ×‘', '×“×’', '×¤×¨×”'], a: 1 },
            { type: 'mc', q: '××”×™ ×‘×™×¨×ª ×™×©×¨××œ?', options: ['×ª×œ ××‘×™×‘', '×™×¨×•×©×œ×™×', '×—×™×¤×”', '×‘××¨ ×©×‘×¢'], a: 1 }
        ];

        const PUNISH = [
            '×ª×‘×—×¨×™ ××§×•× ××¢× ×™×™×Ÿ ×©×× ×™ ××’×¢ ×‘×• 10 ×©× ×™×•×ª ×¨×¦×•×£ ××ª ×‘×•×—×¨×ª ××§×•× ğŸ˜‰',
            '×ª×‘×™××™ ×œ×™ × ×©×™×§×” ××™×¤×” ×©×‘××œ×š)',
            '×× ×™ ×‘×•×—×¨ ××§×•× ×œ×’×¢×ª ×‘×• ×œ5 ×©× ×™×•×ª ××‘×œ',
            '×× ×™ ×‘×•×—×¨ ××§×•× ×©××ª × ×•×’×¢×ª ×‘×• ×œ10 ×©× ×™×•×ª',
            '××ª ×‘×•×—×¨×ª ××§×•× ×©××ª × ×•×’×¢×ª ×‘×• ××‘×œ 5 ×©× ×™×•×ª',
            '×× ×™ ××ª×—×ª ×œ×‘×’×“',
            '××ª ××ª×—×ª ×œ×‘×’×“',
            '× ×©×™×§×” ××™×¤×” ×©×‘××œ×š',
            '× ×©×™×§×” ××™×¤×” ×©×× ×™ ×‘×•×—×¨',
            '× ×©×™×§×” ×¢× ×œ×©×•×Ÿ ×•×”×¨×‘×” ×–××Ÿ',
            '× ×©×™×§×” ×ª×•×š ×›×“×™ ×©×× ×™ ××¨×™× ××•×ª×š',
            '×—×™×‘×•×§ ×¢× × ×’×™×¢×•×ª ×•× ×©×™×§×”',
            '×›×œ ××—×“ ××•××¨ 3 ×“×‘×¨×™× ×©××•×©×›×™× ××•×ª×• ×‘×©× ×™',
            '×× ×™ ×™×•×©×‘ ×¢×œ×™×š ×œ10 ×©× ×™×•×ª',
            '××ª ×™×•×©×‘×ª ×¢×œ×™ ×œ10 ×©× ×™×•×ª',
        ];

        // ===== STATE & DOM =====
        const state = { idx: 0, score: 0, order: [...Array(QUESTIONS.length).keys()], answered: false };
        const el = id => document.getElementById(id);
        const qCard = el('qCard'), qTitle = el('qTitle'), answers = el('answers'), qIndex = el('qIndex'), qTotal = el('qTotal'), bar = el('bar'), progressWrap = el('progressWrap'), feedback = el('feedback'), scorePill = el('scorePill'), end = el('end'), finalScore = el('finalScore'), endMsg = el('endMsg'), whBtn = el('whBtn');
        const nextBtn = el('nextBtn'), skipBtn = el('skipBtn');
        const start = el('start');

        // Music
        const bgm = el('bgm'); const musicToggle = el('musicToggle'); const musicState = el('musicState'); let musicOn = false;
        musicToggle.addEventListener('click', async () => { try { if (!musicOn) { await bgm.play(); musicOn = true; musicState.textContent = '×× ×’×Ÿ'; musicToggle.innerHTML = 'â¸ï¸ ×”×©×ª×§'; } else { bgm.pause(); musicOn = false; musicState.textContent = '××•×©×ª×§'; musicToggle.innerHTML = 'ğŸµ × ×’×Ÿ'; } } catch (e) { alert('×™×™×ª×›×Ÿ ×©×”×“×¤×“×¤×Ÿ ×—×¡× × ×™×’×•×Ÿ ××•×˜×•××˜×™. × ×¡×• ×œ×œ×—×•×¥ ×©×•×‘.'); } });
        document.addEventListener('click', async function once() { document.removeEventListener('click', once); try { await bgm.play(); musicOn = true; musicState.textContent = '×× ×’×Ÿ'; musicToggle.innerHTML = 'â¸ï¸ ×”×©×ª×§'; } catch (e) { } }, { once: true, capture: true });

        // Modes
        el('modeSoft').addEventListener('click', () => { alert(" × ×¨××œ×š?! ×”×™×•× ××ª×¤×¨×¢×™×!"); });
        el('modeFun').addEventListener('click', () => { alert('××¦×—×™×§ ×•××ª×•×§ ×–×” ×œ× ×”×™×•×.. ××•×œ×™ ×¨×§ ××ª×•×§'); });
        el('modeSpicy').addEventListener('click', () => { start.classList.add('hidden'); qCard.classList.remove('hidden'); progressWrap.classList.remove('hidden'); initGame(); });

        function initGame() { state.idx = 0; state.score = 0; state.answered = false; scorePill.textContent = 'ğŸ’— 0'; qTotal.textContent = state.order.length; showQuestion(); }

        nextBtn.addEventListener('click', () => { state.idx++; if (state.idx >= state.order.length) return finish(); showQuestion(); });
        skipBtn.addEventListener('click', () => { feedback.textContent = '×“×™×œ×•×’ ××œ×’× ×˜×™. ×××©×™×›×™× â¤ï¸'; nextBtn.disabled = false; });

        function pct() { return Math.round(100 * state.idx / state.order.length) }
        function normalize(t) { return (t || '').toString().trim().toLowerCase().replace(/["'×´×³\-]/g, '').replace(/\s+/g, ' ') }

        function showQuestion() {
            state.answered = false; feedback.textContent = ''; nextBtn.disabled = true;
            const qi = state.order[state.idx]; const q = QUESTIONS[qi];
            qIndex.textContent = state.idx + 1; bar.style.width = pct() + '%'; qTitle.textContent = q.q; answers.innerHTML = '';
            if (q.type === 'mc') {
                q.options.forEach((opt, i) => {
                    const btn = document.createElement('button'); btn.className = 'answer'; btn.type = 'button'; btn.textContent = opt;
                    btn.addEventListener('click', () => selectAnswer(btn, i === q.a)); answers.appendChild(btn);
                });
            } else { // text
                const wrap = document.createElement('div'); wrap.style.display = 'grid'; wrap.style.gap = '10px';
                const input = document.createElement('input'); input.type = 'text'; input.placeholder = '×›×ª×‘×• ×›××Ÿ ×ª×©×•×‘×”'; input.style.padding = '12px 14px'; input.style.border = '1px solid #2a2a32'; input.style.borderRadius = '12px'; input.style.background = '#0f0f13'; input.style.color = 'var(--text)';
                const btn = document.createElement('button'); btn.className = 'btn btn-primary'; btn.textContent = '×‘×“×™×§×”';
                btn.addEventListener('click', () => {
                    const val = normalize(input.value);
                    let ok = false;
                    if (Array.isArray(q.answer)) ok = q.answer.some(a => val.includes(normalize(a)) || normalize(a).includes(val));
                    else ok = val === normalize(q.answer);
                    selectAnswer(btn, ok, true);
                });
                wrap.appendChild(input); wrap.appendChild(btn); answers.appendChild(wrap);
            }
        }

        function selectAnswer(node, correct, isText = false) {
            if (state.answered) return; state.answered = true;
            if (!isText) { [...answers.querySelectorAll('.answer')].forEach(b => b.disabled = true); node.classList.add(correct ? 'correct' : 'wrong'); }
            if (correct) { state.score++; scorePill.textContent = 'ğŸ’— ' + state.score; feedback.textContent = '×‘×•×œ! ğŸŒŸ'; confetti.burst(); }
            else { feedback.textContent = '×¤×¡×¤×¡×ªâ€¦ ×—×•×‘×” ×¨× ×“×•××œ×™×ª ×‘×“×¨×š!'; showPunish(); }
            nextBtn.disabled = false;
        }

        // Punish modal
        const punishModal = document.getElementById('punishModal');
        const punishText = document.getElementById('punishText');
        document.getElementById('okPunish').addEventListener('click', () => { punishModal.style.display = 'none' });
        document.getElementById('skipPunish').addEventListener('click', () => { punishModal.style.display = 'none' });
        function showPunish() {
            punishText.textContent = PUNISH[Math.floor(Math.random() * PUNISH.length)];
            punishModal.style.display = 'grid';
        }

        function finish() {
            qCard.classList.add('hidden'); progressWrap.classList.add('hidden'); end.classList.remove('hidden');
            finalScore.textContent = '×¦×™×•×Ÿ: ' + state.score + '/' + state.order.length;
            const rate = state.score / state.order.length;
            endMsg.textContent = rate >= .8 ? '×—× ×¤×”â€¦ ×”××©×›×™×•×ª ××ª×‘×§×©×ª ğŸ˜‰' : (rate >= .6 ? '×™×© ××ª×— ×‘××•×•×™×¨ â€“ ×¡×™×‘×•×‘ × ×•×¡×£?' : '×”×¦×™×•×Ÿ ×œ× ×§×•×‘×¢, ×”×§×¨×‘×” ×›×Ÿ. ×××©×™×›×™×?');
            confetti.burst(innerWidth / 2, innerHeight / 3, 140);
            const shareTxt = encodeURIComponent(`×¡×™×™×× ×• ××ª "Spicy Mode" ×¢× ×¦×™×•×Ÿ ${state.score}/${state.order.length} ğŸ”¥`);
            whBtn.href = `https://wa.me/?text=${shareTxt}`;
        }
    </script>
</body>
</html>
